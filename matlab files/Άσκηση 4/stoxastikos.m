
A=[0,1,0,0,0,0,0,0,1,0,0,0,0,0,0;
   0,0,1,0,1,0,1,0,0,0,0,0,0,0,0;
   0,1,0,0,0,1,0,1,0,0,0,0,0,0,0;
   0,0,1,0,0,0,0,0,0,0,0,1,0,0,0;
   1,0,0,0,0,0,0,0,0,1,0,0,0,0,0;
   0,0,0,0,0,0,0,0,0,1,1,0,0,0,0;
   0,0,0,0,0,0,0,0,0,1,1,0,0,0,0;
   0,0,0,1,0,0,0,0,0,0,1,0,0,0,0;
   0,0,0,0,1,1,0,0,0,1,0,0,0,0,0;  
   0,0,0,0,0,0,0,0,0,0,0,0,1,0,0;
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,1;
   0,0,0,0,0,0,1,1,0,0,1,0,0,0,0;
   0,0,0,0,0,0,0,0,1,0,0,0,0,1,0;
   0,0,0,0,0,0,0,0,0,1,1,0,1,0,1;
   0,0,0,0,0,0,0,0,0,0,0,1,0,1,0];


n=15;
s1=sum(A);
I=eye(n,n);
e=ones (n,1);
p=.85;
delta=(1-p)/n;
D=spdiags(1./s1',0,n,n);
x=(I-p*A*D)\(delta*e);
G=p*A*D+delta;

s2=sum(G);